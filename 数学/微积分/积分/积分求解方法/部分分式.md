---
tags:
  - calculus
  - Integral
---

微积分中计算**有理函数积分**（多项式除以多项式）
将一个复杂的、难以直接积分的分数，拆解成几个简单的、可以直接利用基本积分公式计算的“小分数”之和。

## 求解步骤
### 检查被积函数 $f(x) = \frac{P(x)}{Q(x)}$
- **真分式（Proper Rational Function）：** 分子 $P(x)$ 的最高次幂必须**严格小于**分母 $Q(x)$ 的最高次幂。
- **如果不是：** 如果分子的次数大于或等于分母（假分式），必须先进行**多项式长除法**，将其化为“多项式 + 真分式”的形式，再对剩下的真分式部分使用部分分式法。

#### 长除法示例
$$
\int \frac{5x^2 + x - 3}{x^2 - 1} \mathrm{d}x,
$$

除法算式如下：（5在最左边）

$$
\begin{array}{r}
5 \\
x^2 - 1 \overline{) \ 5x^2 + x - 3} \\
\underline{5x^2 \phantom{+x} - 5} \\
x + 2
\end{array}
$$

这个除法告诉我们，商为 5，余数为 $x+2$。所以有

$$
\frac{5x^2 + x - 3}{x^2 - 1} = 5 + \frac{x + 2}{x^2 - 1}.
$$

## 核心计算
1. **分解分母：** 将分母 $Q(x)$ 彻底因式分解为一次因式（$(ax+b)$）和不可约的二次因式（$(ax^2+bx+c)$）的乘积。
2. **拆分形式（设立待定系数）：** 根据分母的因子类型，写出对应的拆分形式（见下表）。
3. **求解系数：** 通分后，利用“比较系数法”或“赋值法”解出待定系数 $A, B, C$ 等。
4. **逐项积分：** 将拆分后的简单分式分别积分。通常结果会涉及自然对数 $\ln|u|$ 或反正切函数 $\arctan(u)$。

### 常见拆分规则表
假设分母 $Q(x)$ 已经被分解，针对不同的因子类型，拆分规则如下：
**重复**是分母出现了$n$次幂的形式

| 分母中的因子类型 (Factor) | 对应的部分分式形式 (Term) |
| :--- | :--- |
| **互异一次因子** $(ax+b)$ | $\frac{A}{ax+b}$ |
| **重复一次因子** $(ax+b)^k$ | $\frac{A_1}{ax+b} + \dots + \frac{A_k}{(ax+b)^k}$ |
| **不可约二次因子** $(ax^2+bx+c)$ | $\frac{Ax+B}{ax^2+bx+c}$ |
| **重复二次因子** $(ax^2+bx+c)^k$ | $\frac{A_1x+B_1}{ax^2+bx+c} + \dots + \frac{A_kx+B_k}{(ax^2+bx+c)^k}$ |

#### 计算示例
$$\int \frac{1}{x^2 - 1} \, dx$$

1. **分解分母：** $x^2 - 1 = (x-1)(x+1)$。
2. 设立方程：$$\frac{1}{(x-1)(x+1)} = \frac{A}{x-1} + \frac{B}{x+1}$$
3. 1. **求解系数：** 通分得 $1 = A(x+1) + B(x-1)$。
    - 令 $x=1$ $\Rightarrow 1 = 2A \Rightarrow A = 1/2$
    - 令 $x=-1$ $\Rightarrow 1 = -2B \Rightarrow B = -1/2$
4. 积分：$$\int (\frac{1/2}{x-1} - \frac{1/2}{x+1}) \, dx = \frac{1}{2}\ln|x-1| - \frac{1}{2}\ln|x+1| + C$$

